# NestJS Template

[ä¸­æ–‡ç‰ˆ](README.md) | [English Version](README-EN.md)

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ NestJS åç«¯é¡¹ç›®æ¨¡æ¿ï¼Œé›†æˆäº†å¸¸ç”¨åŠŸèƒ½å’Œæœ€ä½³å®è·µã€‚

## ç‰¹æ€§

- ğŸš€ åŸºäº Fastify çš„é«˜æ€§èƒ½ HTTP æœåŠ¡å™¨
- ğŸ“ é›†æˆ Swagger æ–‡æ¡£ï¼ˆOpenAPIï¼‰
- ğŸ”’ å…¨å±€å¼‚å¸¸å¤„ç†å’Œç»Ÿä¸€å“åº”æ ¼å¼
- ğŸ“Š Winston æ—¥å¿—ç³»ç»Ÿï¼ˆæŒ‰æ—¥æœŸè½®è½¬ï¼‰
- ğŸ’¾ Prisma ORM é›†æˆ
- âš¡ï¸ è¯·æ±‚è¶…æ—¶å¤„ç†
- âœ¨ ç»Ÿä¸€çš„å“åº”æ•°æ®è½¬æ¢

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ api/                # API æ¨¡å—ç›®å½•
â”‚   â”œâ”€â”€ demo/          # ç¤ºä¾‹æ¨¡å—
â”‚   â””â”€â”€ index.ts       # API è·¯ç”±æ³¨å†Œ
â”œâ”€â”€ common/            # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ logger/        # æ—¥å¿—æ¨¡å—
â”‚   â””â”€â”€ prisma/        # Prisma æ•°æ®åº“æ¨¡å—
â”œâ”€â”€ core/              # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ decorator/     # è‡ªå®šä¹‰è£…é¥°å™¨
â”‚   â”œâ”€â”€ filter/        # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ guard/         # å®ˆå«
â”‚   â””â”€â”€ interceptor/   # æ‹¦æˆªå™¨
â””â”€â”€ main.ts            # åº”ç”¨å…¥å£æ–‡ä»¶
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16
- pnpm >= 8

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
```

### æ•°æ®åº“è¿æ¥

å°†ä½äº `src/common/prisma/prisma.service.ts:51` è¡Œä»£ç å–æ¶ˆæ³¨é‡Šï¼Œå¹¶è®¾ç½®æ•°æ®åº“è¿æ¥

### å¯åŠ¨é¡¹ç›®

```bash
# dev
pnpm run start:dev

# prod
pnpm run start:prod

# build
pnpm run build
```

### è®¿é—®æ–‡æ¡£

```bash
http://localhost:8080/docs
```

## ä¸»è¦åŠŸèƒ½è¯´æ˜

### ç»Ÿä¸€å“åº”æ ¼å¼

æˆåŠŸå“åº”æ ¼å¼

```json
{
  "code": "SUCCESS",
  "data": {},
  "message": "è¯·æ±‚æˆåŠŸ",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

é”™è¯¯å“åº”æ ¼å¼

```json
{
  "code": "ERROR_CODE",
  "message": "é”™è¯¯ä¿¡æ¯",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/xxx"
}
```

### æ—¥å¿—ç³»ç»Ÿ

- è‡ªåŠ¨æŒ‰æ—¥æœŸåˆ†å‰²æ—¥å¿—æ–‡ä»¶
- åŒºåˆ† error å’Œ combined æ—¥å¿—
- å¼€å‘ç¯å¢ƒä¸‹åŒæ—¶è¾“å‡ºåˆ°æ§åˆ¶å°
- æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ logs ç›®å½•

### å¼‚å¸¸å¤„ç†

- å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨å¤„ç†æ‰€æœ‰æœªæ•è·çš„å¼‚å¸¸
- HTTP å¼‚å¸¸è¿‡æ»¤å™¨å¤„ç†æ ‡å‡†çš„ HTTP å¼‚å¸¸
- Prisma æ•°æ®åº“å¼‚å¸¸ç»Ÿä¸€å¤„ç†

### è¯·æ±‚è¶…æ—¶å¤„ç†

é»˜è®¤ 60 ç§’è¶…æ—¶é™åˆ¶ï¼Œå¯é€šè¿‡ TimeoutInterceptor é…ç½®

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æ¨¡å—

1. åœ¨ `src/api` ç›®å½•ä¸‹åˆ›å»ºæ–°æ¨¡å—ç›®å½•ï¼Œä¾‹å¦‚ `user`
2. åœ¨ `src/api/user/user.service.ts` ä¸­å®šä¹‰æœåŠ¡
3. åœ¨ `src/api/user/user.controller.ts` ä¸­å®šä¹‰æ§åˆ¶å™¨
4. åœ¨ `src/api/user/user.module.ts` ä¸­å®šä¹‰æ¨¡å—
5. åœ¨ `src/api/index.ts` ä¸­æ³¨å†Œæ–°æ¨¡å—

### ä½¿ç”¨è‡ªå®šä¹‰å“åº”æ ¼å¼

ä½¿ç”¨ `@SkipTransform()` è£…é¥°å™¨å¯ä»¥è·³è¿‡ç»Ÿä¸€å“åº”æ ¼å¼è½¬æ¢ï¼š

```typescript
@Get()
@SkipTransform()
getData() {
  return { raw: 'data' };
}
```

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request

## è®¸å¯è¯

MIT

```json
  "builds": [
    {
      "src": "dist/main.js",
      "use": "@vercel/node"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "dist/main.js",
      "methods": ["GET", "POST", "PUT", "DELETE"]
    }
  ],
```
